name: 'Check Job Status'
description: 'Check the status of all jobs'

inputs:
  jobs:
    description: 'The needs context containing the job information'
    required: true
outputs:
  all_jobs_succeeded:
    description: 'Whether all jobs have succeeded'
    value: ${{ steps.check_status.outputs.all_jobs_succeeded }}

runs:
  using: 'composite'
  steps:
    - name: Check Job Status
      id: check_status
      run: |
        all_jobs_succeeded=true
        echo "$jobs"
        echo "$jobs" | jq -c '.[] | .result' | while read -r result; do
          echo "結果: $result"
          if [ "$result" != '"success"' ]; then
            all_jobs_succeeded=false
            break
          fi
        done
        echo "all_jobs_succeeded=$all_jobs_succeeded" >> $GITHUB_OUTPUT
      shell: bash
